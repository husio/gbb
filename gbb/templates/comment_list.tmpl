{{template "header.tmpl"}}

{{template "toggle_logged.tmpl"}}

<style>
.comment { padding: 10px; margin: 20px 0; }
.comment-content { padding-left: 20px; }
</style>

<body>
  <span id="top"></span>

  <p>
    <a href="/p/">Back to listing</a>
  </p>

  <hr>

  <h1>{{.Post.Subject}}</h1>
  {{range .Comments}}
    <div class="comment" id="comment-{{.CommentID}}">
      <div class="comment-header">
        <a href="#comment-{{.CommentID}}" title="direct link to the comment">#</a>
        <a href="/u/{{.Author.UserID}}">{{.Author.Name}}</a>
        at <span title="{{.Created.Format "2006-01-02 at 15:04 -0700"}}">{{.Created.Format "Monday, _2 Jan 2006"}}</span>
      </div>
      <div class="comment-content">
        <p>{{.Content | markdown}}</p>
      </div>
    </div>
  {{else}}
    No comments
  {{end}}

  <hr>

  <p>
    Pagination:
    {{range .Pagination.Pages}}
      {{if .Active}}
        {{.Number}}
      {{else}}
        <a href="./?page={{.Number}}">{{.Number}}</a>
      {{end}}
      {{if not .IsLast}}, {{end}}
    {{end}}
  </p>

  <p>
    {{if .Pagination.HasPrevPage}}
      <a href="./?page={{.Pagination.PrevPage}}">Previous page</a>
    {{else}}
      Previous page
    {{end}}
    | Page {{.Pagination.CurrentPage}} of {{.Pagination.PageCount}} |
    {{if .Pagination.HasNextPage}}
      <a href="./?page={{.Pagination.NextPage}}">Next page</a>
    {{else}}
        NextPage
    {{end}}
  </p>

  <p>
    <a href="#top">Top of the page</a>
    |
    <a href="/p/">Back to listing</a>
  </p>

  <form method="POST" action="/p/{{.Post.PostID}}/comment/" enctype="multipart/form-data" autocomplete="off">
    <textarea name="content" id="comment-content" data-unauthenticated-disabled="true" placeholder="Write your comment. Use markdown." required></textarea>
    <button type="submit" data-unauthenticated-disabled="true">Comment</button>
    <span data-authenticated-display="inline" style="display:none">
      writing as <em data-authenticated-content="Name"></em>
    </span>
    <span data-unauthenticated-display="inline" style="display:none">
      You must <a href="/login/?next=/p/{{.Post.PostID}}/">login</a> to comment.
    </span>


  </form>
  <span id="bottom"></span>
</body>
